{% extends 'blog/base.html' %}

{% block title %}Accueil - Blog Acad√©mique Universitaire{% endblock %}

{% block content %}
<!-- Section Hero avec fond color√© -->
<div
    class="bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-800 rounded-2xl shadow-2xl p-12 mb-12 text-white relative overflow-hidden">
    <!-- √âl√©ments d√©coratifs de fond -->
    <div class="absolute inset-0 bg-black bg-opacity-10"></div>
    <div
        class="absolute top-0 right-0 w-64 h-64 bg-white bg-opacity-5 rounded-full transform translate-x-32 -translate-y-32">
    </div>
    <div
        class="absolute bottom-0 left-0 w-48 h-48 bg-white bg-opacity-5 rounded-full transform -translate-x-24 translate-y-24">
    </div>

    <!-- Contenu principal -->
    <div class="relative z-10 max-w-4xl mx-auto text-center">
        <!-- Titre principal -->
        <h1 class="text-5xl md:text-6xl font-bold mb-6 leading-tight">
            üìö Blog Acad√©mique Universitaire
        </h1>

        <!-- Sous-titre -->
        <p class="text-xl md:text-2xl text-blue-100 mb-10 leading-relaxed">
            D√©couvrez des articles de recherche, des analyses, et des r√©flexions acad√©miques
        </p>

        <!-- Barre de recherche -->
        <div class="max-w-2xl mx-auto">
            <form method="GET" action="{% url 'home' %}" class="relative">
                <div class="flex items-center bg-white rounded-full shadow-lg overflow-hidden">
                    <input type="text" name="search" value="{{ search_query|default:'' }}"
                        placeholder="Rechercher par titre ou auteur..."
                        class="flex-1 px-6 py-4 text-gray-900 text-lg focus:outline-none focus:ring-0 placeholder-gray-500">
                    <button type="submit"
                        class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 transition-colors duration-200 font-semibold">
                        üîç Rechercher
                    </button>
                </div>
            </form>

            <!-- Suggestions de recherche -->
            <div class="mt-4 flex flex-wrap justify-center gap-2">
                <span class="text-blue-200 text-sm">Recherches populaires :</span>
                <a href="?search=python"
                    class="bg-blue-500 bg-opacity-50 hover:bg-opacity-70 text-white px-3 py-1 rounded-full text-sm transition-all duration-200">
                    Python
                </a>
                <a href="?search=intelligence"
                    class="bg-blue-500 bg-opacity-50 hover:bg-opacity-70 text-white px-3 py-1 rounded-full text-sm transition-all duration-200">
                    Intelligence Artificielle
                </a>
                <a href="?search=recherche"
                    class="bg-blue-500 bg-opacity-50 hover:bg-opacity-70 text-white px-3 py-1 rounded-full text-sm transition-all duration-200">
                    Recherche
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Section des 4 cartes de statistiques -->
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
    <!-- Articles publi√©s -->
    <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-shadow duration-300">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wide">Articles publi√©s
                </p>
                <p class="text-3xl font-bold text-blue-600 dark:text-blue-400 mt-2">{{ stats.total_articles|default:0 }}
                </p>
                <p class="text-sm text-gray-500 dark:text-gray-500 mt-1">Total des publications</p>
            </div>
            <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center">
                <span class="text-2xl">üìÑ</span>
            </div>
        </div>
    </div>

    <!-- Auteurs actifs -->
    <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-shadow duration-300">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wide">Auteurs actifs
                </p>
                <p class="text-3xl font-bold text-green-600 dark:text-green-400 mt-2">{{stats.total_auteurs|default:0}}
                </p>
                <p class="text-sm text-gray-500 dark:text-gray-500 mt-1">Contributeurs uniques</p>
            </div>
            <div class="w-12 h-12 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center">
                <span class="text-2xl">üë•</span>
            </div>
        </div>
    </div>

    <!-- Lecteurs ce mois -->
    <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-shadow duration-300">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wide">Lectures ce mois
                </p>
                <p class="text-3xl font-bold text-purple-600 dark:text-purple-400 mt-2">
                    {{stats.lecteurs_ce_mois|default:0}}</p>
                <p class="text-sm text-gray-500 dark:text-gray-500 mt-1">Nouveaux articles vus</p>
            </div>
            <div class="w-12 h-12 bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center">
                <span class="text-2xl">üëÅÔ∏è</span>
            </div>
        </div>
    </div>

    <!-- Commentaires -->
    <div
        class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700 hover:shadow-xl transition-shadow duration-300">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wide">Commentaires</p>
                <p class="text-3xl font-bold text-orange-600 dark:text-orange-400 mt-2">
                    {{stats.total_commentaires|default:0}}</p>
                <p class="text-sm text-gray-500 dark:text-gray-500 mt-1">Total des interactions</p>
            </div>
            <div class="w-12 h-12 bg-orange-100 dark:bg-orange-900 rounded-lg flex items-center justify-center">
                <span class="text-2xl">üí¨</span>
            </div>
        </div>
    </div>
</div>

<!-- Section des r√©sultats de recherche ou articles r√©cents -->
<div class="mb-12">
    {% if search_query %}
    <!-- R√©sultats de recherche -->
    <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">
            üîç R√©sultats de recherche pour "{{ search_query }}"
        </h2>
        <p class="text-gray-600 dark:text-gray-400 mb-6">
            {{ articles.count }} r√©sultat{{ articles.count|pluralize }} trouv√©{{ articles.count|pluralize }}
        </p>
    </div>

    {% if articles %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {% for article in articles %}
        <article
            class="bg-white dark:bg-gray-800 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2 overflow-hidden border border-gray-200 dark:border-gray-700">
            <!-- Image de l'article ou placeholder -->
            <div class="h-48 overflow-hidden">
                {% if article.image %}
                <img src="{{ article.image.url }}" alt="{{ article.titre }}" 
                     class="w-full h-full object-cover transition-transform duration-300 hover:scale-105">
                {% else %}
                <div class="w-full h-full bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 flex items-center justify-center">
                    <div class="text-center text-gray-400 dark:text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"></path>
                        </svg>
                        <span class="text-sm font-medium">üìÑ Article</span>
                    </div>
                </div>
                {% endif %}
            </div>
            
            <div class="p-6">
                {% if article.categorie %}
                <span class="inline-block px-3 py-1 text-xs font-semibold text-white rounded-full mb-4"
                    style="background-color: {{ article.categorie.couleur }};">
                    {{ article.categorie.nom }}
                </span>
                {% endif %}

                <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-3 leading-tight">
                    <a href="{% url 'detail_article' article.id %}"
                        class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-200">
                        {{ article.titre }}
                    </a>
                </h3>

                <div class="flex items-center text-sm text-gray-500 dark:text-gray-400 mb-4">
                    <span class="font-medium">{{ article.auteur }}</span>
                    <span class="mx-2">‚Ä¢</span>
                    <span>{{ article.date_creation|date:"d/m/Y" }}</span>
                </div>

                <p class="text-gray-700 dark:text-gray-300 mb-6 leading-relaxed">
                    {{ article.contenu|truncatewords:25 }}
                </p>

                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-500 dark:text-gray-400 flex items-center">
                        üí¨ {{ article.commentaires.count }} commentaire{{ article.commentaires.count|pluralize }}
                    </span>
                    <a href="{% url 'detail_article' article.id %}"
                        class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200 text-sm font-medium">
                        Lire l'article
                    </a>
                </div>
            </div>
        </article>
        {% endfor %}
    </div>
    {% else %}
    <!-- Aucun r√©sultat trouv√© -->
    <div
        class="bg-gray-50 dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-12 text-center">
        <div class="text-6xl mb-4">üîç</div>
        <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">Aucun r√©sultat trouv√©</h3>
        <p class="text-gray-600 dark:text-gray-400 mb-6">
            Aucun article ne correspond √† votre recherche "{{ search_query }}".
        </p>
        <div class="space-x-4">
            <a href="{% url 'home' %}"
                class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium">
                Voir tous les articles
            </a>
            <a href="{% url 'ajouter_article' %}"
                class="bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition-colors duration-200 font-medium">
                Cr√©er un article
            </a>
        </div>
    </div>
    {% endif %}
    {% else %}
    <!-- Articles r√©cents (quand pas de recherche) -->
    <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">
            üìÑ Articles r√©cents
        </h2>
        <p class="text-gray-600 dark:text-gray-400 mb-6">
            D√©couvrez les derni√®res publications acad√©miques
        </p>
    </div>

    {% if articles %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {% for article in articles|slice:":6" %}
        <article
            class="bg-white dark:bg-gray-800 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2 overflow-hidden border border-gray-200 dark:border-gray-700">
            <!-- Image de l'article ou placeholder -->
            <div class="h-48 overflow-hidden">
                {% if article.image %}
                <img src="{{ article.image.url }}" alt="{{ article.titre }}" 
                     class="w-full h-full object-cover transition-transform duration-300 hover:scale-105">
                {% else %}
                <div class="w-full h-full bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 flex items-center justify-center">
                    <div class="text-center text-gray-400 dark:text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"></path>
                        </svg>
                        <span class="text-sm font-medium">üìÑ Article</span>
                    </div>
                </div>
                {% endif %}
            </div>
            
            <div class="p-6">
                {% if article.categorie %}
                <span class="inline-block px-3 py-1 text-xs font-semibold text-white rounded-full mb-4"
                    style="background-color: {{ article.categorie.couleur }};">
                    {{ article.categorie.nom }}
                </span>
                {% endif %}

                <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-3 leading-tight">
                    <a href="{% url 'detail_article' article.id %}"
                        class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-200">
                        {{ article.titre }}
                    </a>
                </h3>

                <div class="flex items-center text-sm text-gray-500 dark:text-gray-400 mb-4">
                    <span class="font-medium">{{ article.auteur }}</span>
                    <span class="mx-2">‚Ä¢</span>
                    <span>{{ article.date_creation|date:"d/m/Y" }}</span>
                </div>

                <p class="text-gray-700 dark:text-gray-300 mb-6 leading-relaxed">
                    {{ article.contenu|truncatewords:25 }}
                </p>

                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-500 dark:text-gray-400 flex items-center">
                        üí¨ {{ article.commentaires.count }} commentaire{{ article.commentaires.count|pluralize }}
                    </span>
                    <a href="{% url 'detail_article' article.id %}"
                        class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200 text-sm font-medium">
                        Lire l'article
                    </a>
                </div>
            </div>
        </article>
        {% endfor %}
    </div>

    <!-- Bouton voir plus -->
    {% if articles.count > 6 %}
    <div class="text-center mt-12">
        <a href="{% url 'articles' %}"
            class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-8 py-4 rounded-xl hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 font-semibold text-lg shadow-lg">
            Voir tous les articles ({{ articles.count }})
        </a>
    </div>
    {% endif %}
    {% else %}
    <!-- Aucun article -->
    <div
        class="bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-12 text-center">
        <div class="text-6xl mb-4">üìö</div>
        <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">Aucun article publi√©</h3>
        <p class="text-gray-600 dark:text-gray-400 mb-6">
            Soyez le premier √† partager vos recherches et analyses acad√©miques !
        </p>
        <a href="{% url 'ajouter_article' %}"
            class="bg-blue-600 text-white px-8 py-4 rounded-xl hover:bg-blue-700 transition-colors duration-200 font-semibold text-lg">
            ‚úçÔ∏è Publier le premier article
        </a>
    </div>
    {% endif %}
    {% endif %}
</div>
{% endblock %}